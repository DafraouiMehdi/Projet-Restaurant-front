<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">

	<title>Pizza - free responsive website template</title>
	<meta name="keywords" content="">
	<meta name="description" content="">
    <meta name="author" content="templatemo">
    <!-- 
    Pizza Template
    http://www.templatemo.com/preview/templatemo_459_pizza
    -->
    
	<meta http-equiv="X-UA-Compatible" content="IE=Edge">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- bootstrap -->
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<!-- font-awesome -->
	<link rel="stylesheet" href="css/font-awesome.min.css">
	<!-- custom -->
	<link rel="stylesheet" href="css/templatemo-style.css">
	<!-- google font -->
	<link href='//fonts.googleapis.com/css?family=Signika:400,300,600,700' rel='stylesheet' type='text/css'>
	<link href='//fonts.googleapis.com/css?family=Chewy' rel='stylesheet' type='text/css'>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
	<style>
		/* General Navbar Styling */
/* General Navbar Styling */
.navbar-collapse {
    display: flex;
    justify-content: flex-start; /* Align items to the left */
    align-items: center; /* Center items vertically */
    flex-grow: 1; /* Make navbar-collapse grow to fill space */
}

/* Styling for navigation links */
.navbar-nav {
    display: flex;
    list-style: none;
    margin-left: 15px; /* Add spacing between logo and nav items */
}

.navbar-nav li {
    margin: 0 15px; /* Add spacing between nav items */
}

.navbar-nav a {
    text-decoration: none;
    color: #333;
    font-weight: bold;
    transition: color 0.3s ease;
}

.navbar-nav a:hover {
    color: #f8a835;
}

/* Right-Aligned Button Styling */
.navbar-right {
    display: flex;
    align-items: center; /* Center the button vertically */
    margin-left: auto; /* Push the button to the right */
}

.navbar-right button {
    background-color: #f8a835;
    color: white;
    border: none;
    border-radius: 20px;
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
    transition: background-color 0.3s ease, transform 0.3s ease;
	margin-top: 5%;
}

.navbar-right button:hover {
    background-color: #d17a1c;
    transform: scale(1.05);
}

.navbar-right #client-name {
    font-size: 16px;
    font-weight: bold;
}


/* Logo Styling */
.navbar-brand {
    display: flex;
    align-items: center; /* Vertically center the logo */
    padding: 0; /* Remove default padding */
}

.navbar-brand .logo-img {
    height: 50px; /* Adjust logo size */
    width: auto; /* Maintain aspect ratio */
    transition: transform 0.3s ease; /* Add hover effect */
}

.navbar-brand:hover .logo-img {
    transform: scale(1.1); /* Slight zoom on hover */
}

/* Ensure responsive alignment */
.navbar-header {
    display: flex;
    align-items: center;
    margin-right: auto; /* Keep the logo to the left */
}

.card-img-top {
    object-fit: cover;
    height: 200px; /* Uniform height */
    width: 100%;   /* Occupy full width */
}

/* Modal Overlay */
.modal {
  position: fixed; /* Ensures it overlays the slider */
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  background-color: rgba(0, 0, 0, 0.5); /* Transparent dark background */
  z-index: 1000; /* Higher than the slider's z-index */
}

/* Modal Overlay */
.modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  background-color: rgba(0, 0, 0, 0.5);
  z-index: 1000;
}

/* Modal Content */
.modal-content {
  background-color: white;
  padding: 20px;
  border-radius: 10px;
  text-align: center;
  max-width: 600px;
  width: 90%;
  box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
}

/* Modal Overlay */
.modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  background-color: rgba(0, 0, 0, 0.5);
  z-index: 1000;
}

/* Modal Content */
.modal-content {
  background-color: white;
  padding: 20px;
  border-radius: 10px;
  text-align: center;
  max-width: 600px;
  width: 90%;
  box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
}

/* Modal Form - Two Columns */
.modal-form {
  display: flex;
  gap: 20px;
  margin-top: 20px;
}

.form-column {
  flex: 1; /* Ensures both columns are equal in width */
  display: flex;
  flex-direction: column;
  gap: 10px; /* Space between input fields */
}

.modal-form input {
  width: 100%;
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 5px;
  font-size: 16px;
}

/* Modal Footer - Buttons Aligned */
.modal-footer {
  margin-top: 20px;
  display: flex;
  justify-content: space-between;
}

.btn {
  padding: 10px 20px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  font-size: 16px;
}

.btn-secondary {
  background-color: #ccc;
  color: #333;
}

.btn-secondary:hover {
  background-color: #bbb;
}

.btn-primary {
  background-color: #007bff;
  color: white;
}

.btn-primary:hover {
  background-color: #0056b3;
}

.success-popup {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: #28a745;
    color: white;
    padding: 20px 30px; /* Increased padding for a more spacious look */
    border-radius: 8px; /* Slightly more rounded corners */
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2); /* Stronger shadow for depth */
    display: none;
    align-items: center;
    font-size: 1.1rem;
    text-align: center;
    z-index: 9999; /* Higher z-index to ensure it's above other elements */
    opacity: 0;
    transition: opacity 0.6s ease-out, transform 0.5s ease-in-out; /* Smooth transition */
    max-width: 400px; /* Maximum width for the popup */
    width: 100%;
    box-sizing: border-box; /* Ensures padding is included in the width */
    border: 2px solid #218838; /* Adds a border for more definition */
}

.success-popup.show {
    display: flex;
    opacity: 1;
    transform: translate(-50%, -50%) scale(1.05); /* Slightly larger scale for better effect */
}

.success-popup i {
    margin-right: 15px; /* Increased margin for better spacing */
    font-size: 1.6rem; /* Larger icon for better visibility */
}

.success-popup .message {
    font-weight: 600; /* Bold text for the message */
}

/* Optional animation for the icon */
.success-popup i {
    animation: bounce 1s infinite; /* Bouncing icon for extra attention */
}

/* Keyframes for icon bounce */
@keyframes bounce {
    0%, 100% {
        transform: translateY(0);
    }
    50% {
        transform: translateY(-10px);
    }
}





/* Styling for the navbar-right and button */
.navbar-right {
    display: flex;
    justify-content: flex-end;
    align-items: center;
}

.navbar-right button {
    margin-left: 15px;
    padding: 10px 20px;
    font-size: 1rem;
    border: none;
    cursor: pointer;
    border-radius: 5px;
    margin-top: 3%;
    position: relative; /* Ensure relative positioning for child elements */
    transition: background-color 0.3s ease, transform 0.3s ease;
}

/* Styling for the 'client-name' button */
.navbar-right button#client-name {
    background-color: #007bff;
    color: white;
}

.navbar-right button#client-name:hover {
    background-color: #0056b3;
    transform: scale(1.05);
}

/* Styling for the 'Panier' button */
.navbar-right button:last-child {
    background-color: #ffc107;
    color: white;
    font-size: larger;
    display: flex;
    align-items: center;
}

/* Styling for the 'Panier' button on hover */
.navbar-right button:last-child:hover {
    background-color: #e0a800;
    transform: scale(1.05);
}


/* CSS Styling */
        .modalPanier {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            width: 400px;
            display: none;
            flex-direction: column;
            align-items: center;
        }

        .modal-content {
            width: 100%;
        }

        #order-list {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 15px;
        }

        .modalPanier button {
            margin: 5px;
        }

        .card {
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 15px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .card img {
            object-fit: cover;
            height: 200px;
            width: 100%;
        }

        .card-footer {
            text-align: center;
            background-color: #f8f9fa;
        }

        .btn {
            padding: 8px 12px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .btn-primary {
            background-color: #007bff;
            color: white;
        }

        .btn-danger {
            background-color: #dc3545;
            color: white;
        }

        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }

        .btn-success {
            background-color: #28a745;
            color: white;
        }

        .btn:hover {
            opacity: 0.9;
        }

        input[type="number"] {
        width: 50px;
        height: 20px;
        font-size: 12px;
        text-align: center;
    }


	</style>
</head>
<body id="home" data-spy="scroll" data-target=".navbar-collapse">

	<!-- start navigation -->
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon icon-bar"></span>
                <span class="icon icon-bar"></span>
                <span class="icon icon-bar"></span>
            </button>
            <div class="navbar-header">
                <a href="#home" class="navbar-brand smoothScroll">
                    <img src="logo.jpg" alt="Logo" class="logo-img">
                </a>
            </div>
        </div>
        <div class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <!-- Left/Central Navigation Links -->
                <li><a href="#home" class="smoothScroll">HOME</a></li>
                <li><a href="#about" class="smoothScroll">ABOUT</a></li>
                <li><a href="#gallery" class="smoothScroll">GALLERY</a></li>
                <li><a href="#plats" class="smoothScroll">PLATS</a></li>
                <li><a href="#contact" class="smoothScroll">CONTACT</a></li>
            </ul>
        
            <!-- Right-Aligned Button -->
            <div class="navbar-right ms-auto">
                <button onclick="handlePopup()" id="client-name">
                    <span id="client-name-text"></span>
                </button>
                <button onclick="handlePanier()">
                    Panier <span id="counter" style="color: black; margin-left: 20%;">0</span>
                </button>
            </div>
            
        </div>
    </div>
</div>
<!-- end navigation -->

<!-- Popup Modal -->
<div id="confirmation-modal" class="modal" style="display: none;">
	<div class="modal-content">
	  <h4>Update Your Information</h4>
	  <p>Would you like to modify your personal details?</p>
	  <div class="modal-form">
		<div class="form-column">
		  <input type="text" id="firstname" >
		  <input type="text" id="lastname" >
		  <input type="email" id="email" >
		</div>
		<div class="form-column">
		  <input type="password" id="password" >
		  <input type="text" id="adresse" >
		  <input type="tel" id="phone" >
		</div>
	  </div>
	  <div class="modal-footer">
		<button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
		<button class="btn btn-primary" onclick="editDetails()">Update</button>
	  </div>
	</div>
  </div>

<!-- Order Popup -->
<div id="order-popup" class="modalPanier">
    <div class="modal-content">
        <h4>Les Commandes</h4>
        <div id="order-list">
            <!-- Orders will be dynamically added here -->
        </div>
        <h4 id="total"></h4>
        <div class="text-center mt-3">
            <button class="btn btn-success" onclick="submitOrders()">Accepter</button>
            <button class="btn btn-secondary" onclick="closeOrdersPopup()">Fermer</button>
        </div>
    </div>
</div>
  
  
  
  <!-- Flexslider -->
  <div class="flexslider">
	<ul class="slides">
	  <li>
		<img src="images/slider-img1.jpg" alt="Pizza Image 1">
		<div class="flex-caption">
		  <h2 class="slider-title">We make Pizza</h2>
		  <h3 class="slider-subtitle">Fresh, clean, and delicious.</h3>
		  <p class="slider-description">
			Praesent tincidunt neque semper elementum gravida. Donec id euismod magna. Ut erat ligula, malesuada eu quam a, fringilla auctor augue.
		  </p>
		</div>
	  </li>
	  <li>
		<img src="images/slider-img2.jpg" alt="Pizza Image 2">
		<div class="flex-caption">
		  <h2 class="slider-title">Freshly Baked Pizza</h2>
		  <h3 class="slider-subtitle">Premium Quality, Finest Ingredients</h3>
		  <p class="slider-description">
			Donec id euismod magna. Ut erat ligula, malesuada eu quam a, fringilla auctor augue. Praesent tincidunt neque semper elementum gravida.
		  </p>
		</div>
	  </li>
	</ul>
  </div>
  

	<!-- start about -->
	<section id="about" class="templatemo-section templatemo-top-130">
		<div class="container">
			<div class="row">
				<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
					<h1 class="text-uppercase">Your Pizza Shop</h1>
				</div>
				<div class="col-md-6 col-sm-6">					
					<h3 class="text-uppercase padding-bottom-10">Another Baker</h3>
					<p>Pizza responsive web template is provided by <a rel="nofollow" href="http://www.templatemo.com" target="_parent">templatemo</a> website. Feel free to download, adapt, and use this template for your websites. Credit goes to <a rel="nofollow" href="http://pixabay.com" target="_parent">Pixabay</a> for images used in this template.</p>
                    <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet. Dolore magna aliquam erat volutpat.</p>
					<p>Proin enim sem, ultricies sit amet convallis nec, sodales quis augue. Duis consequat felis ac justo luctus, a cursus tellus pharetra. In ullamcorper gravida enim id pulvinar.</p>
				</div>
				<div class="col-md-6 col-sm-6">
					<img src="images/about-img1.jpg" class="img-responsive img-bordered img-about" alt="about img">
				</div>
			</div>
		</div>
	</section>
	<!-- end about -->

	<!-- start gallery -->
	<section id="gallery" class="templatemo-section templatemo-light-gray-bg">
		<div class="container">
			<div class="row">
				<div class="col-md-12">
					<h2 class="text-center text-uppercase">Gallery</h2>
					<hr>
				</div>
				<div class="col-md-4 col-sm-4">
					<div class="gallery-wrapper">
						<img src="images/gallery-img1.jpg" class="img-responsive gallery-img" alt="Pizza 1">
						<div class="gallery-des">
							<h3>Curabitur </h3>
							<h5>Cras in ante mattis, elementum nunc sed.</h5>
						</div>
					</div>
				</div>	
				<div class="col-md-4 col-sm-4">
					<div class="gallery-wrapper">
						<img src="images/gallery-img2.jpg" class="img-responsive gallery-img" alt="Pizza 2">
						<div class="gallery-des">
							<h3>Lorem ipsum</h3>
							<h5>In ullamcorper gravida enim id pulvinar</h5>
						</div>
					</div>
				</div>
				<div class="col-md-4 col-sm-4">
					<div class="gallery-wrapper">
						<img src="images/gallery-img3.jpg" class="img-responsive gallery-img" alt="Pizza 3">
						<div class="gallery-des">
							<h3>Pellentesque</h3>
							<h5>Maecenas efficitur nisi id sapien</h5>
						</div>
					</div>
				</div>
				<div class="col-md-6 col-sm-6">
					<div class="gallery-wrapper">
						<img src="images/gallery-img4.jpg" class="img-responsive gallery-img" alt="Pizza 4">
						<div class="gallery-des">
							<h3>Suspendisse</h3>
							<h5>Mauris sit amet augue sit amet risus</h5>
						</div>
					</div>
				</div>
				<div class="col-md-6 col-sm-6">
					<div class="gallery-wrapper">
						<img src="images/gallery-img5.jpg" class="img-responsive gallery-img" alt="Pizza 5">
						<div class="gallery-des">
							<h3>Elementum</h3>
							<h5>Maecenas efficitur nisi id sapien</h5>
						</div>
					</div>
				</div>				
			</div>
		</div>
	</section>
	<!-- end gallery -->

	<section id="plats" class="templatemo-section templatemo-light-gray-bg py-5">
		<div class="container">
			<div class="row mb-4">
				<div class="col-md-12">
					<h2 class="text-center text-uppercase">Plats</h2>
					<hr>
				</div>
			</div>
			<div class="row gx-4 gx-lg-5">
				<!-- Les plats seront ajoutés ici dynamiquement -->
			</div>
		</div>
	</section>	
	

	<!-- start contact -->
	<section id="contact" class="templatemo-section">
		<div class="container">
			<div class="row">
				<div class="col-md-12">
					<h2 class="text-uppercase text-center">Contact Us</h2>
					<hr>
				</div>
				<div class="col-md-2"></div>
				<div class="col-md-8">
					<form action="#" method="post" role="form">
						<div class="col-md-6 col-sm-6">
							<input name="name" type="text" class="form-control" id="name" maxlength="60" placeholder="Name">
					    	<input name="email" type="email" class="form-control" id="email" placeholder="Email">
							<input name="message" type="text" class="form-control" id="message" placeholder="Subject">
						</div>
						<div class="col-md-6 col-sm-6">
							<textarea class="form-control" rows="5" placeholder="Message"></textarea>
						</div>
						<div class="col-md-offset-3 col-md-6 col-sm-offset-3 col-sm-6">
							<input name="submit" type="submit" class="form-control" id="submit" value="Send">
						</div>
					</form>
				</div>
				<div class="col-md-2"></div>
				<div class="col-md-4 col-sm-4">
					<h3 class="padding-bottom-10 text-uppercase">Visit our shop</h3>
					<p><i class="fa fa-map-marker contact-fa"></i>Casablanca , ben M'sik sidi othmane</p>
					<p>
						<i class="fa fa-phone contact-fa"></i> 
						<a href="tel:010-020-0340" class="contact-link">010-020-0340</a>, 
						<a href="tel:080-090-0660" class="contact-link">080-090-0660</a>
					</p>			
					<p><i class="fa fa-envelope-o contact-fa"></i> 
                    	<a href="mailto:hello@company.com" class="contact-link">zri9a@restaurant.com</a></p>
				</div>
				<div class="col-md-4 col-sm-4">
					<h3 class="text-uppercase">Opening hours</h3>
					<p><i class="fa fa-clock-o contact-fa"></i> 7:00 AM - 11:00 PM</p>
					<p><i class="fa fa-bell-o contact-fa"></i> Monday to Friday and Sunday</p>
                    <p><i class="fa fa-download contact-fa"></i> 
                    	<a class="contact-link" rel="nofollow" 
                        	href="http://fontawesome.io/icons/" target="_blank">Change Icons</a></p>
			  	</div>
				<div class="col-md-4 col-sm-4">
					<div class="google_map">
						<div id="map-canvas" class="map"></div>
					</div>
				</div>
			</div>
		</div>
	</section>
	<!-- end contact -->

	<!-- start footer -->
	<footer>
		<div class="container">
			<div class="row">
				<div class="col-md-12">
					<p>Copyright &copy; 2084 Restaurant Zri9a</p>
					<hr>
					<ul class="social-icon">
						<li><a href="#" class="fa fa-facebook"></a></li>
						<li><a href="#" class="fa fa-twitter"></a></li>
						<li><a href="#" class="fa fa-instagram"></a></li>
						<li><a href="#" class="fa fa-google"></a></li>
					</ul>
				</div>
			</div>
		</div>
	</footer>
	<!-- end footer -->

    <div class="success-popup" id="successPopup">
        <i class="fas fa-check-circle"></i>
        Updated with successfully!
    </div>

	<script src="js/jquery.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/plugins.js"></script>
	<script src="js/smoothscroll.js"></script>
	<script src="js/custom.js"></script>


    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const user = localStorage.getItem('userData') ? JSON.parse(localStorage.getItem('userData')) : null;
            if (!user) {
                alert('Aucune donnée utilisateur trouvée. Redirection vers la connexion...');
                window.location.href = 'http://127.0.0.1:8080/connection.html';
                return;
            }
    
            document.getElementById('client-name').textContent = `Bienvenue, ${user.first_name} ${user.last_name}`;
    
            const productContainer = document.querySelector('.row.gx-4.gx-lg-5');
            productContainer.innerHTML = `<p>Loading products...</p>`;

            window.handlePopup = () => {
                const modal = document.getElementById('confirmation-modal');
                modal.style.display = 'flex';
                document.getElementById("firstname").value = user.first_name || '';
                document.getElementById("lastname").value = user.last_name || '';
                document.getElementById("email").value = user.email || '';
                document.getElementById("adresse").value = user.adresse || '';
                document.getElementById("password").value = user.password || '';
                document.getElementById("phone").value = user.phone || '';
            };

            window.closeModal = () => {
                document.getElementById('confirmation-modal').style.display = 'none';
            };

            window.editDetails = () => {
                const firstname = document.getElementById("firstname").value.trim();
                const lastname = document.getElementById("lastname").value.trim();
                const email = document.getElementById("email").value.trim();
                const adresse = document.getElementById("adresse").value.trim();
                const password = document.getElementById("password").value.trim();
                const phone = document.getElementById("phone").value.trim();

                if (!firstname || !lastname || !email || !adresse || !phone) {
                    alert("Tous les champs doivent être remplis.");
                    return;
                }

                const dataUpdate = {
                    no: user.no,
                    first_name: firstname || undefined,
                    last_name: lastname || undefined,
                    email: email || undefined,
                    adresse: adresse || undefined,
                    password: password || undefined,
                    phone: phone || undefined
                };

                Object.keys(dataUpdate).forEach(key => {
                    if (dataUpdate[key] === undefined) {
                        delete dataUpdate[key];
                    }
                });

                console.log("Data to update:", dataUpdate);

                fetch("http://localhost:4433/PHP/PJResBack/clients/update.php", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify(dataUpdate)
                })
                .then(response => response.json())
                .then(jsonData => {
                    if (jsonData.success) {
                        alert("Vos informations ont été mises à jour avec succès!");
                        localStorage.setItem('userData', JSON.stringify(jsonData.user));
                        document.getElementById('client-name').textContent = `Bienvenue, ${jsonData.user.first_name} ${jsonData.user.last_name}`;
                        closeModal();
                        let successPopup = document.getElementById("successPopup")
                        successPopup.classList.add('show');
                        setTimeout(() => successPopup.classList.remove('show'), 3000);
                        setTimeout(()=>window.location.reload() , 1000);
                    } else {
                        alert("Erreur lors de la mise à jour des informations: " + jsonData.message);
                    }
                })
                .catch(error => {
                    console.error("Error updating user details:", error);
                    alert("Une erreur est survenue lors de la mise à jour des informations. Veuillez réessayer plus tard.");
                });
            };
    
            let orders = [];
            let counter = 0;

            function openOrdersPopup() {
                const modal = document.getElementById('order-popup');
                modal.style.display = 'block';
                const orderList = document.getElementById('order-list');
                orderList.innerHTML = '';    
                if (orders.length === 0) {
                    orderList.innerHTML = `<p>Aucune commande ajoutée.</p>`;
                    return;
                }
                
                let TotalPrice = 0;

                orders.forEach((order, index) => {
                    const orderItem = document.createElement('div');
                    orderItem.innerHTML = `
                        <p>
                            <strong>Plat:</strong> ${order.name} | 
                            <strong>Prix Unitaire:</strong> ${order.price} USD
                        </p>
                        <label for="quantity-${index}" style="font-size: 12px; margin-right: 5px;">Quantité :</label>
                        <input type="number" id="quantity-${index}" 
                            value="${order.quantity || 1}" 
                            min="1" 
                            style="width: 50px; height: 20px; font-size: 12px; text-align: center;"
                            onchange="updateQuantity(${index}, this.value)" />
                        <p id="item-total-${index}" style="font-size: 12px;">
                            Total pour ce plat : ${(order.price * (order.quantity || 1)).toFixed(2)} USD
                        </p>
                        <button class="btn btn-danger btn-sm" onclick="removeOrder(${index})">Supprimer</button>
                    `;

                    TotalPrice += order.price * (order.quantity || 1);

                    orderList.appendChild(orderItem);
                });

                const h4Total = document.getElementById("total");
                h4Total.innerHTML = `Total des commandes : ${TotalPrice.toFixed(2)} USD`;

                window.updateQuantity = (index, newQuantity) => {
                    const quantity = Math.max(1, parseInt(newQuantity, 10) || 1); 
                    orders[index].quantity = quantity;

                    const itemTotal = document.getElementById(`item-total-${index}`);
                    itemTotal.textContent = `Total pour ce plat : ${(orders[index].price * quantity).toFixed(2)} USD`;

                    updateTotalPrice();
                };

                const updateTotalPrice = () => {
                    TotalPrice = orders.reduce((sum, order) => {
                        return sum + (order.price * (order.quantity || 1));
                    }, 0);

                    h4Total.innerHTML = `Total des commandes : ${TotalPrice.toFixed(2)} USD`;
                };

                window.removeOrder = (index) => {
                    const orderToRemove = orders[index];
                    TotalPrice -= orderToRemove.price * (orderToRemove.quantity || 1);
                    orders.splice(index, 1);
                    updateTotalPrice();
                    openOrdersPopup();
                };
            }

            function removeOrder(index) {
                orders.splice(index, 1);
                counter -= 1;
                document.getElementById("counter").textContent = counter;
                openOrdersPopup();
            }

            function closeOrdersPopup() {
                const modal = document.getElementById('order-popup');
                modal.style.display = 'none';
            }

            function submitOrders() {
                if (orders.length === 0) {
                    alert('Aucune commande à envoyer!');
                    return;
                }

                const formattedOrders = orders.map(order => ({
                    client_id: order.client_no,   
                    plat_id: order.plat_no,       
                    quantity: order.quantity || 1, 
                    price: order.price            
                }));

                console.log("Données envoyées:", formattedOrders);

                fetch("http://localhost:4433/PHP/PJResBack/commandes/platcommande.php", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify(formattedOrders),
                })
                .then((response) => response.json())
                .then((data) => {
                    console.log("Réponse du serveur:", data);
                    if (data.success) {
                        alert("Commandes envoyées avec succès!");
                        orders = [];
                    } else {
                        alert("Erreur lors de l'envoi des commandes: " + data.message);
                    }
                })
                .catch((error) => {
                    console.error("Erreur lors de l'envoi des commandes:", error);
                    alert("Une erreur s'est produite. Veuillez réessayer plus tard.");
                });
            }


    
            window.handlePanier = () => {
                openOrdersPopup();
            };
    
            fetch("http://localhost:4433/PHP/PJResBack/plats/afficher.php")
                .then((response) => response.json())
                .then((data) => {
                    if (Array.isArray(data) && data.length > 0) {
                        productContainer.innerHTML = ''; 
                        data.forEach((product) => {
                            const productCard = document.createElement('div');
                            productCard.classList.add('col-md-4', 'mb-5');
                            productCard.innerHTML = `
                                <div class="card h-100 shadow-sm">
                                    <img 
                                        class="card-img-top" 
                                        src="http://localhost:4433/PHP/PJResBack/plats/images/${product.image_path || ''}" 
                                        alt="${product.name}" 
                                        style="object-fit: cover; height: 200px; width: 100%;" 
                                        onerror="this.src='https://dummyimage.com/450x300/dee2e6/6c757d.jpg'" />
                                    <div class="card-body text-center">
                                        <h5 class="card-title fw-bold">${product.name}</h5>
                                        <p class="card-text">${product.description}</p>
                                        <div class="text-muted">${product.price} USD</div>
                                    </div>
                                    <div class="card-footer text-center bg-light">
                                        <button class="btn btn-primary" 
                                            onclick="handleCommande(${user.no}, ${product.no}, '${product.name}', ${product.price})">
                                            Commander
                                        </button>
                                    </div>
                                </div>
                            `;
                            productContainer.appendChild(productCard);
                        });
                    } else {
                        productContainer.innerHTML = `<p>No products available.</p>`;
                    }
                })
                .catch((error) => {
                    console.error('Error fetching product data:', error);
                    productContainer.innerHTML = `<p>Error loading products. Please try again later.</p>`;
                });
    
            window.handleCommande = (client_no, plat_no, name, price) => {
                orders.push({ client_no, plat_no, name, price });
                document.getElementById("counter").textContent = counter += 1;
            };
    
            window.openOrdersPopup = openOrdersPopup;
            window.closeOrdersPopup = closeOrdersPopup;
            window.submitOrders = submitOrders;
            window.removeOrder = removeOrder;
        });
    </script>
    


	

<script
src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap"
async
defer>
</script>
		

	

</body>
</html>